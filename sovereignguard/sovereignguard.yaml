# SovereignGuard v1.0 Configuration
# Automated Security Orchestration System
# Purpose: Eliminate all 36 exposure vectors through defense-in-depth

name: SovereignGuard
version: "1.0.0"
purpose: "Eliminate all 36 exposure vectors through automated security orchestration"
philosophy: "Defense in depth through sovereign infrastructure"

# Core Modules Configuration
core_modules:
  credential_vault:
    enabled: true
    technology:
      - "YubiKey HSM"
      - "Hashicorp Vault"
      - "TPM 2.0"
    addresses_exposures: [1, 2, 3, 4, 5, 6]
    status: "design_phase"
    config:
      vault_addr: "${VAULT_ADDR:-http://vault:8200}"
      vault_namespace: "sovereignguard"
      seal_type: "tpm"
      auto_unseal: true
      audit_enabled: true
      policies_dir: "/vault/policies"
      
  service_mesh:
    enabled: true
    technology:
      - "Linkerd"
      - "SPIFFE/SPIRE"
      - "Kubernetes NetworkPolicies"
    addresses_exposures: [7, 8, 19, 20, 21, 24]
    status: "design_phase"
    config:
      mtls_enabled: true
      identity_mode: "spiffe"
      default_policy: "deny-all"
      proxy_log_level: "warn"
      tap_enabled: true
      
  financial_enclave:
    enabled: true
    technology:
      - "Microsoft SEAL"
      - "Intel SGX"
      - "AMD SEV"
    addresses_exposures: [11, 12, 17, 25, 30]
    status: "research_phase"
    config:
      enclave_mode: "sgx"
      encryption_scheme: "ckks"
      key_rotation_days: 30
      max_transaction_without_approval: 100
      human_approval_required: true
      
  airgap_inference:
    enabled: true
    technology:
      - "Ollama"
      - "Physical Network Isolation"
      - "Sneakernet Queue"
    addresses_exposures: [13, 14, 15, 16, 26]
    status: "design_phase"
    config:
      inference_host: "airgap-node"
      queue_in_path: "/mnt/usb/inference-queue-in"
      queue_out_path: "/mnt/usb/inference-queue-out"
      max_queue_size_mb: 1024
      model: "qwen2.5:72b"
      
  immutable_audit:
    enabled: true
    technology:
      - "OpenTimestamps"
      - "Elasticsearch"
      - "WORM Storage"
    addresses_exposures: [9, 10, 22, 23, 27]
    status: "prototype_phase"
    config:
      elasticsearch_host: "elasticsearch:9200"
      blockchain_anchor: true
      anchor_interval_hours: 24
      retention_days: 2555  # 7 years
      worm_enabled: true
      
  chaos_testing:
    enabled: true
    technology:
      - "Chaos Mesh"
      - "Custom Attack Sims"
      - "Anomaly Detection"
    addresses_exposures: [18, 28, 29]
    status: "design_phase"
    config:
      schedule: "0 2 * * 0"  # Sundays at 2 AM
      auto_rollback: true
      max_blast_radius: 0.25  # 25% of services
      experiments:
        - "pod-kill"
        - "network-partition"
        - "credential-leak-test"
        - "cpu-stress"
        - "io-chaos"

# Integration Points
integration:
  nats_jetstream:
    enabled: true
    url: "nats://nats:4222"
    stream: "sovereignguard-events"
    subjects:
      - "security.alert.*"
      - "security.incident.*"
      - "security.audit.*"
      
  discord_control:
    enabled: true
    webhook_url: "${DISCORD_SECURITY_WEBHOOK:-}"
    channels:
      alerts: "${DISCORD_ALERTS_CHANNEL:-}"
      incidents: "${DISCORD_INCIDENTS_CHANNEL:-}"
      audit: "${DISCORD_AUDIT_CHANNEL:-}"
    severity_routing:
      critical: "alerts"
      high: "alerts"
      medium: "incidents"
      low: "audit"
      
  swarmgate:
    enabled: true
    config_path: "/etc/swarmgate/config.yaml"
    protection_layer: true
    
  legion_of_minds:
    enabled: true
    threat_analysis: true
    models:
      - "qwen2.5:72b"
      - "llama3.1:8b"
    inference_type: "local"

# Deployment Phases
deployment:
  phases:
    - name: "phase_1"
      description: "Credential vault (fixes 6 exposures)"
      modules: ["credential_vault"]
      timeline: "Month 1-2"
      exposures_fixed: [1, 2, 3, 4, 5, 6]
      
    - name: "phase_2"
      description: "Service mesh (fixes 6 exposures)"
      modules: ["service_mesh"]
      timeline: "Month 3-4"
      exposures_fixed: [7, 8, 19, 20, 21, 24]
      
    - name: "phase_3"
      description: "Financial enclave (fixes 5 exposures)"
      modules: ["financial_enclave"]
      timeline: "Month 5-6"
      exposures_fixed: [11, 12, 17, 25, 30]
      
    - name: "phase_4"
      description: "Air-gap inference (fixes 5 exposures)"
      modules: ["airgap_inference"]
      timeline: "Month 7-8"
      exposures_fixed: [13, 14, 15, 16, 26]
      
    - name: "phase_5"
      description: "Immutable audit (fixes 5 exposures)"
      modules: ["immutable_audit"]
      timeline: "Month 9-10"
      exposures_fixed: [9, 10, 22, 23, 27]
      
    - name: "phase_6"
      description: "Chaos testing (fixes 3 exposures)"
      modules: ["chaos_testing"]
      timeline: "Month 11-12"
      exposures_fixed: [18, 28, 29]

# KPIs and Success Metrics
kpis:
  credential_exposure:
    current: 6
    target: 0
    unit: "active vectors"
    measurement: "Annual red team pentest"
    
  lateral_movement_time:
    current: 5
    target: 10080  # 7 days in minutes
    unit: "minutes"
    measurement: "Chaos engineering tests"
    
  mean_time_to_detect:
    current: null  # Unknown
    target: 60
    unit: "seconds"
    measurement: "Security event pipeline latency"
    
  mean_time_to_respond:
    current: 1440  # 1 day in minutes
    target: 5
    unit: "minutes"
    measurement: "Incident response automation"
    
  false_positive_rate:
    current: null
    target: 1
    unit: "percent"
    measurement: "Security alert accuracy"

# Cost Analysis
cost_analysis:
  hardware:
    yubikey: 50
    tpm_module: 30
    airgap_usb: 20
    total_hardware: 100
  software:
    vault: 0  # Open source
    linkerd: 0  # Open source
    chaos_mesh: 0  # Open source
    elasticsearch: 0  # Open source
    total_software: 0
  comparison:
    traditional_security_team: 150000  # Per year
    sovereignguard_total: 100
    roi_multiplier: 1500  # 1500x cost reduction

# Security Manifesto
manifesto:
  - principle: "Every credential is a liability"
    solution: "Vault eliminates credentials from memory"
    
  - principle: "Every network connection is a threat"
    solution: "Service mesh enforces zero-trust"
    
  - principle: "Every financial transaction is a target"
    solution: "Enclaves protect trading logic"
    
  - principle: "Every AI inference is surveillance"
    solution: "Air-gaps prevent data exfiltration"
    
  - principle: "Every action must be auditable"
    solution: "Blockchain anchoring prevents tampering"
    
  - principle: "Every system will eventually fail"
    solution: "Chaos testing builds resilience"

# Alerting Configuration
alerting:
  severity_levels:
    critical:
      description: "Immediate action required"
      response_time: "5 minutes"
      escalation: "Discord + SMS + Email"
      auto_response: true
      
    high:
      description: "Urgent attention needed"
      response_time: "30 minutes"
      escalation: "Discord + Email"
      auto_response: true
      
    medium:
      description: "Should be addressed soon"
      response_time: "4 hours"
      escalation: "Discord"
      auto_response: false
      
    low:
      description: "Informational"
      response_time: "24 hours"
      escalation: "Log only"
      auto_response: false

# Compliance Mapping
compliance:
  frameworks:
    - name: "SOC 2"
      controls:
        credential_vault: ["CC6.1", "CC6.6", "CC6.7"]
        service_mesh: ["CC6.1", "CC6.6", "CC7.1"]
        immutable_audit: ["CC2.1", "CC4.1", "CC4.2"]
        
    - name: "ISO 27001"
      controls:
        credential_vault: ["A.9.2", "A.9.4", "A.10.1"]
        service_mesh: ["A.13.1", "A.13.2", "A.14.1"]
        immutable_audit: ["A.12.4", "A.16.1"]
        
    - name: "NIST CSF"
      controls:
        credential_vault: ["PR.AC-1", "PR.AC-4", "PR.AC-7"]
        service_mesh: ["PR.DS-2", "PR.DS-5", "DE.AE-1"]
        chaos_testing: ["ID.RA-5", "RS.MI-1", "RC.RP-1"]
